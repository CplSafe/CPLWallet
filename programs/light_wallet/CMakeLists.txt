project(LightWallet)

# Suppress stupid warning
if(POLICY CMP0043)
   cmake_policy(SET CMP0043 NEW)
endif()

set(BINARY_NAME "OhlShares_Light_Wallet")
set(VERSION_MAJOR 0)
set(VERSION_MINOR 9)
set(VERSION_PATCH 0)

# Find includes in corresponding build directories
set(CMAKE_INCLUDE_CURRENT_DIR ON)
# Instruct CMake to run moc automatically when needed.
set(CMAKE_AUTOMOC ON)

# Configure the autogenerated .app bundle
if( APPLE )
    set ( OSX_ICON_FILE "${CMAKE_CURRENT_SOURCE_DIR}/images/ohlshares.icns" )
    set_source_files_properties( "${OSX_ICON_FILE}" PROPERTIES MACOSX_PACKAGE_LOCATION Resources )
    set( MACOSX_BUNDLE_BUNDLE_NAME "${BINARY_NAME}.app" )
    set( MACOSX_BUNDLE_EXECUTABLE_NAME ${BINARY_NAME} )
    set( MACOSX_BUNDLE_GUI_IDENTIFIER "com.nathanhourt.ohl.light" )
    SET( MACOSX_BUNDLE_ICON_FILE "ohlshares.icns" )
    set( MACOSX_BUNDLE_INFO_STRING "OhlShares Light Wallet - version ${VERSION_MAJOR}.${VERSION_MINOR}.${VERSION_PATCH}" )
    set( MACOSX_BUNDLE_SHORT_VERSION_STRING "${VERSION_MAJOR}.${VERSION_MINOR}.${VERSION_PATCH}" )
    set( MACOSX_BUNDLE_LONG_VERSION_STRING "${VERSION_MAJOR}.${VERSION_MINOR}.${VERSION_PATCH}" )
    set( MACOSX_BUNDLE_BUNDLE_VERSION "${VERSION_MAJOR}.${VERSION_MINOR}.${VERSION_PATCH}" )
    set( MACOSX_BUNDLE_COPYRIGHT "(C) 2014 God" )
endif()

find_package(Qt5Core)
add_definitions(-DQT_NO_KEYWORDS)

file(GLOB qml_files qml/*.qml qml/*.js)
file(GLOB qrc_files *.qrc)

qt5_add_resources(qrc_sources ${qrc_files})

add_executable(${BINARY_NAME} WIN32 MACOSX_BUNDLE ${OSX_ICON_FILE} main.cpp LightWallet.cpp Account.cpp QtWrappers.cpp ${qrc_sources} ${qml_files})
qt5_use_modules(${BINARY_NAME} Quick Gui Qml)

target_link_libraries(${BINARY_NAME} fc ohl_light_wallet
   ${READLINE_LIBRARIES} ${CMAKE_DL_LIBS} ${PLATFORM_SPECIFIC_LIBS}
   ${crypto_library} ${CrashRpt_LIBRARIES} ${ZLIB_LIBRARY} upnpc-static)
